# Grab the build environment
Import('env')

build_info = env.AlwaysBuild(env.info('buildinfo.d', 'buildinfo.d.in'))

obj_list  = [env.AlwaysBuild(env.gdc('kernel.o', 'kernel.d'))]
obj_list += [env.AlwaysBuild(env.gdc('buildinfo.o', 'buildinfo.d'))]

obj_list += SConscript('arch/SConscript', exports='env')
obj_list += SConscript('boot/SConscript', exports='env')
obj_list += SConscript('dev/SConscript', exports='env')
obj_list += SConscript('event/SConscript', exports='env')
obj_list += SConscript('mem/SConscript', exports='env')
obj_list += SConscript('task/SConscript', exports='env')

kernel = env.AlwaysBuild(env.Link('kernel', obj_list, LINKSCRIPTS = ['kernel/link/linker.ld'], _LIBDIRFLAGS = '-Ltriton', _LIBFLAGS = '-lgphobos'))

Return('kernel')
